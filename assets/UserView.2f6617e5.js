import{_ as V,o as l,c as r,b as e,r as i,w as g,H as L,B as N,D as A,f as b,J as E,K as q,L as R,q as T,s as G,x as B,h as D,m as H,t as C,u as h,n as K,v as P,C as J,i as O,F as S,d as M,z as Q,y as W,M as X,N as Y}from"./index.527efbc1.js";import{_ as Z,a as ee}from"./PostCard.7f5cb926.js";import{u as se,a as te}from"./useChat.afdbcfc4.js";import{g as oe}from"./apiPost.928d9a1c.js";import"./UserInfo.105b4e7d.js";const le={},ae={fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},re=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"},null,-1),ne=[re];function ce(n,v){return l(),r("svg",ae,ne)}var de=V(le,[["render",ce]]);const ue={class:"mb-4 grid gap-x-3 gap-y-1.5 md:grid-cols-3"},ie=e("option",{value:"1",selected:""},"\u6700\u65B0\u8CBC\u6587",-1),_e=e("option",{value:"2"},"\u6700\u820A\u8CBC\u6587",-1),pe=e("option",{value:"3"},"\u71B1\u9580\u8CBC\u6587",-1),he=[ie,_e,pe],ve={class:"md:col-span-2"},fe={class:"flex h-11 border-2 border-black"},me=["onKeyup"],be={emits:["get-posts"],setup(n,{emit:v}){const _=i(""),p=i(1),a=()=>{v("get-posts",p.value,_.value)};return(f,o)=>(l(),r("div",ue,[e("div",null,[g(e("select",{class:"h-11 w-full border-2 border-black",name:"category","onUpdate:modelValue":o[0]||(o[0]=m=>p.value=m),onChange:a},he,544),[[L,p.value,void 0,{number:!0}]])]),e("div",ve,[e("div",fe,[g(e("input",{class:"w-full border-0",type:"text",placeholder:"\u641C\u5C0B\u8CBC\u6587","onUpdate:modelValue":o[1]||(o[1]=m=>_.value=m),onKeyup:A(a,["enter"])},null,40,me),[[N,_.value,void 0,{trim:!0}]]),e("button",{type:"button",class:"flex w-11 items-center justify-center border-l-2 border-black bg-primary",onClick:a},[b(de,{class:"h-8 w-8 text-white"})])])])]))}};const ge={},we=n=>(q("data-v-f726cc7c"),n=n(),R(),n),ye={class:"rounded-lg border-2 border-black bg-white shadow-post"},ke=we(()=>e("div",{class:"border-b-2 border-black p-4"},[e("span",{class:"dot"})],-1));function xe(n,v){return l(),r("div",ye,[ke,E(n.$slots,"default",{},void 0,!0)])}var $e=V(ge,[["render",xe],["__scopeId","data-v-f726cc7c"]]);const Ce={class:"relative mb-4"},Pe={class:"flex h-20 overflow-hidden rounded-lg border-2 border-black bg-white"},Se={class:"aspect-square h-full border-r-2 border-black"},Ie=["src"],Ue={class:"flex w-full justify-between p-4"},Be={key:0,class:"flex items-center justify-center"},De=e("span",null,"\u50B3\u9001\u8A0A\u606F",-1),Ke=e("div",{class:"absolute top-1 right-1 -z-10 h-full w-full rounded-lg border-2 border-black bg-white"},null,-1),Me={key:0},Ve=e("p",{class:"p-8 text-center text-subtitle"}," \u76EE\u524D\u5C1A\u7121\u52D5\u614B\uFF0C\u65B0\u589E\u4E00\u5247\u8CBC\u6587\u5427\uFF01 ",-1),Ae={setup(n){const v=T(),_=G(),p=X(),a=i(p.params.id),f=i(!1),o=i(!0),{handleRoom:m}=se(),j=async()=>{var d;if(f.value)return;const s={receiver:a.value};try{f.value=!0;const t=await te.room(s);if(console.log("res",t),!(t!=null&&t.status))return;m(t==null?void 0:t.data)}catch(t){const u=(d=t.response.data)==null?void 0:d.message;u&&v.error(u)}finally{f.value=!1}},I=i([]),y=(s=1,d="")=>{z()},z=async()=>{try{const s=await oe();s.status&&(o.value=!1,I.value=s.data.data)}catch{o.value=!1,console.log(err)}},k=B(()=>I.value.filter(s=>{var d;return((d=s.userId)==null?void 0:d._id)===a.value}));D(()=>{y()});const c=i({}),w=()=>{o.value=!0,Y(a.value).then(s=>{c.value=s.data.user,o.value=!1}).catch(()=>{o.value=!1,console.log(err)})},x=B(()=>{var t;return(c.value.followers?c.value.followers:[]).map(u=>u.user).includes((t=_.user)==null?void 0:t.id)});D(()=>{w()});const F=()=>{x.value?apiUser.deleteFollow(c.value.id).then(()=>{w()}).catch(s=>{console.log(s)}):apiUser.follow(c.value.id).then(()=>{w()}).catch(s=>{console.log(s)})};return H(p,s=>{s.name==="profile"&&s.params.id&&(a.value=s.params.id,y(),w())}),(s,d)=>{var t,u;return l(),r(S,null,[e("div",Ce,[e("div",Pe,[e("div",Se,[e("img",{src:c.value.photo,alt:"Avatar"},null,8,Ie)]),e("div",Ue,[e("div",null,[e("h2",null,C(c.value.name),1),e("span",null,C((t=c.value.followers)==null?void 0:t.length)+" \u4EBA\u8FFD\u8E64",1)]),a.value!==((u=h(_).user)==null?void 0:u.id)?(l(),r("div",Be,[e("button",{type:"button",class:K(["rounded-lg border-2 border-black px-8 py-1.5 shadow-post hover:bg-primary hover:text-white",h(x)?"bg-secondary":"bg-warning"]),onClick:F},C(h(x)?"\u53D6\u6D88\u8FFD\u8E64":"\u8FFD\u8E64"),3),e("button",{onClick:j,class:"ml-2 flex items-center justify-center rounded-lg border-2 border-black px-6 py-1.5 shadow-post hover:bg-gray-300"},[De,g(b(J,{class:"ml-1 h-4 w-4 animate-spin"},null,512),[[P,f.value]])])])):O("",!0)])]),Ke]),b(be,{onGetPosts:y}),g(e("ul",null,[(l(),r(S,null,M(3,$=>e("li",{key:$,class:"mb-4"},[b(Z)])),64))],512),[[P,o.value]]),g(e("div",null,[h(k).length>0?(l(),r("ul",Me,[(l(!0),r(S,null,M(h(k),($,U)=>(l(),r("li",{key:U,class:K({"mb-4":U<h(k).length-1})},[b(ee,{post:$},null,8,["post"])],2))),128))])):(l(),Q($e,{key:1},{default:W(()=>[Ve]),_:1}))],512),[[P,!o.value]])],64)}}};export{Ae as default};
